---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setupREADME, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# RmdConcord

<!-- badges: start -->
[![R-CMD-check](https://github.com/dmurdoch/RmdConcord/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/dmurdoch/RmdConcord/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

The goal of RmdConcord is to provide support for concordances
in R Markdown files.

This is based on a suggestion and initial code from Heather Turner.
Thanks!

The main use for this in HTML output is to help deciphering HTML Tidy
error messages.  If you replace the original driver with `RmdConcord::html_documentC`, 
`R CMD check` should report locations in the original `.Rmd` file.

With PDF output using `patchDVI::pdf_documentC` (from
`patchDVI` version 1.11.0 or newer), Synctex output will be enabled, and it will be patched
to refer to the `.Rmd` file.  This is helpful in previewers like
the one in TeXworks that can link source to a
preview. This package contains
`RmdConcord::pdf_documentC0`, which does part
of the work (preparing the concordance records)
but doesn't do the patching to make previewers 
work with it.

## Limitations

The Pandoc Commonmark driver is still in
development, so some features supported in
the `rmarkdown` drivers will not be fully
supported using the drivers from this package.
At present I am using Pandoc 2.19.2 and I know of the following
missing features:

- Citations, e.g. `[@doe99]`
- Raw LaTeX will need to be “fenced”, e.g. entered as
  ````
  ```{=latex}
  LaTeX
  ```
  ````
  (The `\pagebreak` and `\newpage` macros receive special treatment, so they don’t need fencing as long as they are separated by blank lines from text above and below.) 

If you notice others, please let me know, e.g.
by posting an issue to the Github site.

These will not cause errors (Markdown doesn't
ever give errors!), but they won't be handled
properly.  We suggest using the `RmdConcord` and `patchDVI` drivers during
early development or to track down obscure bugs,
but using the `rmarkdown` drivers for regular
production.

## Installation

This version of `RmdConcord` makes use of some functions that
will be released in R 4.3.0.  Those functions have
been copied into `RmdConcord`, so the package should
be compatible with older versions of R.

You can install the development version of
`RmdConcord` from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("dmurdoch/RmdConcord")
```

## Example

To embed concordances in an R Markdown HTML document, change
the output YAML to `patchDVI::html_documentC`.  For a PDF document,
use `patchDVI::pdf_documentC`.

```yaml
output: patchDVI::html_documentC
```

This is used in the `Sample.Rmd` vignette, which contains an error on line 23.

```{r example}
library(RmdConcord)
example(processConcordance)
```
